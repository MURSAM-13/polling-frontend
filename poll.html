<!DOCTYPE html>
<html>
<head>
<title>Live Poll</title>
<style>
body{
    font-family: Arial;
    background: linear-gradient(135deg,#43cea2,#185a9d);
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}
.box{
    background:white;
    padding:25px;
    border-radius:10px;
    width:320px;
}
button{
    width:100%;
    padding:10px;
    margin:6px 0;
    background:#185a9d;
    color:white;
    border:none;
    cursor:pointer;
}
</style>
</head>
<body>

<div class="box">
    <h2>Live Poll</h2>

    <button onclick="vote(0)">Option A (<span id="v0">0</span>)</button>
    <button onclick="vote(1)">Option B (<span id="v1">0</span>)</button>
    <button onclick="vote(2)">Option C (<span id="v2">0</span>)</button>
    <button onclick="vote(3)">Option D (<span id="v3">0</span>)</button>

    <p id="msg"></p>
</div>

<script>
const API = "https://polling-backend-5jhn.onrender.com";
const username = localStorage.getItem("user");

function vote(option){
    fetch(API + "/vote",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({username,option})
    })
    .then(res=>res.json())
    .then(data=>{
        if(!data.success){
            document.getElementById("msg").innerText=data.msg;
        }
    });
}

// ðŸ” POLLING EVERY 2 SECONDS
setInterval(()=>{
    fetch(API + "/results")
    .then(res=>res.json())
    .then(votes=>{
        votes.forEach((v,i)=>{
            document.getElementById("v"+i).innerText=v;
        });
    });
},2000);
</script>

</body>
</html>
